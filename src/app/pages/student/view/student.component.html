<app-headernavigation></app-headernavigation>
@if (isLoading) {
  <mat-spinner></mat-spinner>
} @else {
  <form [formGroup]="form" class="row">
    <ng-select
      [items]="institutions"
      appendTo="body"
      bindLabel="keyName"
      formControlName="institution"
    ></ng-select>

    <ng-select
      [items]="academicPrograms"
      appendTo="body"
      bindLabel="keyName"
      formControlName="academicProgram"
    ></ng-select>

    <button mat-flat-button class="primary-button"
            (click)="openStudentDialog()">{{ 'studentPage.registerStudent' | translate }}
    </button>
    <input type="file" #fileInput (change)="onFileSelect($event)" accept=".csv, .xslx" style="display: none;">
    <button mat-flat-button class="primary-button" (click)="fileInput.click()">
      <mat-icon>file_upload</mat-icon>
      {{ 'studentPage.button.import' | translate }}
    </button>
  </form>

  @if (userLoading) {
    <mat-spinner></mat-spinner>
  } @else {
    <table [dataSource]="dataSource" class="mat-elevation-z8" mat-table matSort>

      <ng-container matColumnDef="email">
        <th *matHeaderCellDef mat-header-cell mat-sort-header>{{ 'studentPage.table.email' | translate }}</th>
        <td *matCellDef="let user" mat-cell>{{ user.email }}</td>
      </ng-container>

      <ng-container matColumnDef="userType">
        <th *matHeaderCellDef mat-header-cell mat-sort-header>{{ 'studentPage.table.userType' | translate }}</th>
        <td *matCellDef="let user" mat-cell>{{ 'enum.userType.' + user.userType | translate }}</td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Actions</th>
        <td mat-cell *matCellDef="let element">
          <button>Test</button>
        </td>
      </ng-container>


      <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
      <tr (click)="openStudentDialog(row.id)" *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
    </table>
  }
}


